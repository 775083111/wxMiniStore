{"version":3,"file":"store.js","sources":["../src/common.js","../src/diff.js","../src/index.js"],"sourcesContent":["export const TYPE_ARRAY = \"[object Array]\";\r\nexport const TYPE_OBJECT = \"[object Object]\";\r\nexport const _typeOf = function(val) {\r\n  return Object.prototype.toString.call(val);\r\n};\r\nexport const _deepClone = function(obj) {\r\n  return JSON.parse(JSON.stringify(obj));\r\n};\r\n","import { _typeOf, _deepClone, TYPE_ARRAY, TYPE_OBJECT } from \"./common\";\r\n/**\r\n * diff库\r\n * @author Leisure\r\n * @update 2019.11.27\r\n * @param {object} current - 当前状态\r\n * @param {object} prev - 之前状态\r\n */\r\nconst diff = function diff(current = {}, prev = {}) {\r\n  let result = {};\r\n  updateDiff(current, prev, \"\", result);\r\n  nullDiff(current, prev, \"\", result);\r\n  return result;\r\n};\r\n\r\nconst updateDiff = function updateDiff(\r\n  current = {},\r\n  prev = {},\r\n  root = \"\",\r\n  result = {}\r\n) {\r\n  Object.entries(current).forEach(item => {\r\n    let key = item[0],\r\n      value = item[1],\r\n      path = root === \"\" ? key : root + \".\" + key;\r\n    if (_typeOf(current) === TYPE_ARRAY) {\r\n      path = root === \"\" ? key : root + \"[\" + key + \"]\";\r\n    }\r\n\r\n    if (!prev.hasOwnProperty(key)) {\r\n      if (_typeOf(current) === TYPE_ARRAY) {\r\n        let copyCurrent = _deepClone(current);\r\n        copyCurrent[key] = value;\r\n        Object.keys(result).forEach(rk => {\r\n          if (~rk.indexOf(root + \"[\") || ~rk.indexOf(root + \".\")) {\r\n            delete result[rk];\r\n          }\r\n        });\r\n        result[root] = copyCurrent;\r\n      } else {\r\n        result[path] = value;\r\n      }\r\n    } else if (\r\n      (_typeOf(prev[key]) === TYPE_OBJECT &&\r\n        _typeOf(current[key]) === TYPE_OBJECT) ||\r\n      (_typeOf(prev[key]) === TYPE_ARRAY &&\r\n        _typeOf(current[key]) === TYPE_ARRAY)\r\n    ) {\r\n      updateDiff(current[key], prev[key], path, result);\r\n    } else if (prev[key] !== current[key]) {\r\n      result[path] = value;\r\n    }\r\n  });\r\n  return result;\r\n};\r\n\r\nconst nullDiff = function nullDiff(\r\n  current = {},\r\n  prev = {},\r\n  root = \"\",\r\n  result = {}\r\n) {\r\n  Object.entries(prev).forEach(item => {\r\n    let key = item[0],\r\n      path = root === \"\" ? key : root + \".\" + key;\r\n    if (_typeOf(current) === TYPE_ARRAY) {\r\n      path = root === \"\" ? key : root + \"[\" + key + \"]\";\r\n    }\r\n\r\n    if (!current.hasOwnProperty(key)) {\r\n      if (_typeOf(current) === TYPE_ARRAY) {\r\n        let copyCurrent = _deepClone(current);\r\n        copyCurrent.splice(key, 1);\r\n        Object.keys(result).forEach(rk => {\r\n          if (~rk.indexOf(root + \"[\") || ~rk.indexOf(root + \".\")) {\r\n            delete result[rk];\r\n          }\r\n        });\r\n        result[root] = copyCurrent;\r\n      } else {\r\n        result[path] = null;\r\n      }\r\n    } else if (\r\n      (_typeOf(prev[key]) === TYPE_OBJECT &&\r\n        _typeOf(current[key]) === TYPE_OBJECT) ||\r\n      (_typeOf(prev[key]) === TYPE_ARRAY &&\r\n        _typeOf(current[key]) === TYPE_ARRAY)\r\n    ) {\r\n      nullDiff(current[key], prev[key], path, result);\r\n    }\r\n  });\r\n  return result;\r\n};\r\n\r\nexport default diff;\r\n","import { _typeOf, _deepClone, TYPE_ARRAY, TYPE_OBJECT } from \"./common\";\r\nimport diff from \"./diff\";\r\nimport pkg from \"../package.json\";\r\nconst Version = pkg.version;\r\nconsole.log(\"当前wxministore版本：\" + Version);\r\n/**\r\n * Store\r\n * @author Leisure\r\n * @update 2019.11.27\r\n * @version 1.2.8\r\n */\r\nclass Store {\r\n  version = Version;\r\n  $state = {};\r\n  $r = [];\r\n  constructor(option) {\r\n    //必要参数的默认值处理\r\n    const {\r\n      openPart = false,\r\n      behavior,\r\n      methods = {},\r\n      pageLisener = {},\r\n      nonWritable = false\r\n    } = option;\r\n\r\n    //状态初始化\r\n    this.$state = {};\r\n    if (_typeOf(option.state) === TYPE_OBJECT) {\r\n      this.$state = Object.assign({}, _deepClone(option.state));\r\n    }\r\n    //页面+组件树\r\n    this.$r = [];\r\n    //创建时，添加组件\r\n    const _create = function(r, o = {}) {\r\n      r.$store = {};\r\n      const { useProp } = o;\r\n      if (o.hasOwnProperty(\"useProp\")) {\r\n        if (\r\n          (useProp && typeof useProp === \"string\") ||\r\n          _typeOf(useProp) === TYPE_ARRAY\r\n        ) {\r\n          r.$store.useProp = [].concat(useProp);\r\n        } else {\r\n          r.$store.useProp = [];\r\n        }\r\n      }\r\n\r\n      r.$store.useStore = canUseStore(o);\r\n      if (canUseStore(o)) {\r\n        _store.$r.push(r);\r\n        if (r.$store.useProp) {\r\n          r.setData({\r\n            $state: _filterKey(\r\n              _store.$state,\r\n              r.$store.useProp,\r\n              (key, usekey) => key === usekey\r\n            )\r\n          });\r\n        } else {\r\n          r.setData({\r\n            $state: _store.$state\r\n          });\r\n        }\r\n      }\r\n    };\r\n    //销毁时，移除组件\r\n    const _destroy = function(r) {\r\n      let index = _store.$r.findIndex(item => item === r);\r\n      if (index > -1) {\r\n        _store.$r.splice(index, 1);\r\n      }\r\n    };\r\n    //状态局部模式\r\n    this.$openPart = openPart;\r\n    //其他参数\r\n    const _store = this;\r\n    const pageLife = [\r\n      \"data\",\r\n      \"onLoad\",\r\n      \"onShow\",\r\n      \"onReady\",\r\n      \"onHide\",\r\n      \"onUnload\",\r\n      \"onPullDownRefresh\",\r\n      \"onReachBottom\",\r\n      \"onShareAppMessage\",\r\n      \"onPageScroll\",\r\n      \"onTabItemTap\"\r\n    ];\r\n    const canUseStore = function(o = {}) {\r\n      return (openPart === true && o.useStore === true) || !openPart;\r\n    };\r\n\r\n    const originPage = Page,\r\n      originComponent = Component;\r\n\r\n    //重写Page\r\n    App.Page = function(o = {}, ...args) {\r\n      if (canUseStore(o)) {\r\n        //状态注入\r\n        o.data = Object.assign(o.data || {}, {\r\n          $state: _store.$state\r\n        });\r\n      }\r\n      //行为注入\r\n      Object.keys(methods).forEach(key => {\r\n        //不能是周期事件\r\n        if (\r\n          typeof methods[key] === \"function\" &&\r\n          !pageLife.some(item => item === key)\r\n        ) {\r\n          o[key] = methods[key];\r\n        }\r\n      });\r\n      //覆盖原周期\r\n      const originCreate = o.onLoad;\r\n      o.onLoad = function() {\r\n        _create(this, o);\r\n        originCreate && originCreate.apply(this, arguments);\r\n      };\r\n      const originonDestroy = o.onUnload;\r\n      o.onUnload = function() {\r\n        _destroy(this);\r\n        originonDestroy && originonDestroy.apply(this, arguments);\r\n      };\r\n      //其他页面周期事件注入 pageListener\r\n      Object.keys(pageLisener).forEach(key => {\r\n        //不能是周期事件\r\n        if (\r\n          typeof pageLisener[key] === \"function\" &&\r\n          pageLife.some(item => item === key)\r\n        ) {\r\n          const originLife = o[key];\r\n          o[key] = function() {\r\n            pageLisener[key].apply(this, arguments);\r\n            originLife && originLife.apply(this, arguments);\r\n          };\r\n        }\r\n      });\r\n      originPage(o, ...args);\r\n    };\r\n\r\n    if (!nonWritable) {\r\n      try {\r\n        Page = App.Page;\r\n      } catch (e) {}\r\n    }\r\n\r\n    //重写组件\r\n    App.Component = function(o = {}, ...args) {\r\n      //状态注入\r\n      if (canUseStore(o)) {\r\n        o.data = Object.assign(o.data || {}, {\r\n          $state: _store.$state\r\n        });\r\n      }\r\n      //行为注入\r\n      Object.keys(methods).forEach(key => {\r\n        //不能是周期事件\r\n        if (\r\n          typeof methods[key] === \"function\" &&\r\n          !pageLife.some(item => item === key)\r\n        ) {\r\n          o.methods || (o.methods = {});\r\n          o.methods[key] = methods[key];\r\n        }\r\n      });\r\n      //behavior\r\n      if (behavior) {\r\n        o.behaviors = [behavior, ...(o.behaviors || [])];\r\n      }\r\n      const { lifetimes = {} } = o;\r\n\r\n      let originCreate = lifetimes.attached || o.attached,\r\n        originonDestroy = lifetimes.detached || o.detached;\r\n      const attached = function() {\r\n        _create(this, o);\r\n        originCreate && originCreate.apply(this, arguments);\r\n      };\r\n\r\n      const detached = function() {\r\n        _destroy(this);\r\n        originonDestroy && originonDestroy.apply(this, arguments);\r\n      };\r\n      if (_typeOf(o.lifetimes) === TYPE_OBJECT) {\r\n        o.lifetimes.attached = attached;\r\n        o.lifetimes.detached = detached;\r\n      } else {\r\n        o.attached = attached;\r\n        o.detached = detached;\r\n      }\r\n\r\n      //覆盖原周期\r\n\r\n      originComponent(o, ...args);\r\n    };\r\n    if (!nonWritable) {\r\n      try {\r\n        Component = App.Component;\r\n      } catch (e) {}\r\n    }\r\n  }\r\n\r\n  setState(obj, fn = () => {}) {\r\n    if (_typeOf(obj) !== TYPE_OBJECT) {\r\n      throw new Error(\"setState的第一个参数须为object!\");\r\n    }\r\n    console.time && console.time(\"setState\");\r\n    let prev = this.$state;\r\n    let current = setData(obj, prev);\r\n    this.$state = current;\r\n    //如果有组件\r\n    if (this.$r.length > 0) {\r\n      let diffObj = diff(current, prev);\r\n      console.log(\"diff后实际设置的值：\", _deepClone(diffObj));\r\n      let keys = Object.keys(diffObj);\r\n      if (keys.length > 0) {\r\n        const newObj = {};\r\n        keys.forEach(key => {\r\n          newObj[\"$state.\" + key] = diffObj[key];\r\n        });\r\n        let pros = this.$r.map(r => {\r\n          if (r.$store.hasOwnProperty(\"useProp\")) {\r\n            let useprops = _filterKey(\r\n              newObj,\r\n              r.$store.useProp,\r\n              (key, useKey) =>\r\n                key === \"$state.\" + useKey ||\r\n                !!key.match(new RegExp(\"^[$]state.\" + useKey + \"[.|[]\", \"g\"))\r\n            );\r\n            if (Object.keys(useprops).length > 0) {\r\n              return new Promise(resolve => {\r\n                r.setData(useprops, resolve);\r\n              });\r\n            } else {\r\n              return Promise.resolve();\r\n            }\r\n          }\r\n          return new Promise(resolve => {\r\n            r.setData(newObj, resolve);\r\n          });\r\n        });\r\n        Promise.all(pros).then(fn);\r\n      } else {\r\n        fn();\r\n      }\r\n    } else {\r\n      fn();\r\n    }\r\n    console.timeEnd && console.timeEnd(\"setState\");\r\n  }\r\n  getState() {\r\n    return _deepClone(this.$state);\r\n  }\r\n}\r\n\r\nconst _filterKey = function(obj, useKeys = [], fn) {\r\n  let result = {};\r\n  Object.keys(obj)\r\n    .filter(key =>\r\n      useKeys.some(usekey => {\r\n        return fn(key, usekey);\r\n      })\r\n    )\r\n    .forEach(key => {\r\n      result[key] = obj[key];\r\n    });\r\n  return result;\r\n};\r\n\r\nconst setData = function(obj, data) {\r\n  let result = _deepClone(data);\r\n  let origin = _deepClone(obj);\r\n  Object.keys(origin).forEach(key => {\r\n    dataHandler(key, origin[key], result);\r\n  });\r\n  return result;\r\n};\r\n\r\nconst dataHandler = function(key, result, data) {\r\n  let arr = pathHandler(key);\r\n  let d = data;\r\n  for (let i = 0; i < arr.length - 1; i++) {\r\n    keyToData(arr[i], arr[i + 1], d);\r\n    d = d[arr[i]];\r\n  }\r\n  d[arr[arr.length - 1]] = result;\r\n};\r\n\r\nconst pathHandler = function(key) {\r\n  let current = \"\",\r\n    keyArr = [];\r\n  for (let i = 0, len = key.length; i < len; i++) {\r\n    if (key[0] === \"[\") {\r\n      throw new Error(\"key值不能以[]开头\");\r\n    }\r\n    if (key[i].match(/\\.|\\[/g)) {\r\n      cleanAndPush(current, keyArr);\r\n      current = \"\";\r\n    }\r\n    current += key[i];\r\n  }\r\n  cleanAndPush(current, keyArr);\r\n  return keyArr;\r\n};\r\n\r\nconst cleanAndPush = function(key, arr) {\r\n  let r = cleanKey(key);\r\n  if (r !== \"\") {\r\n    arr.push(r);\r\n  }\r\n};\r\n\r\nconst keyToData = function(prev, current, data) {\r\n  if (prev === \"\") {\r\n    return;\r\n  }\r\n  const type = _typeOf(data[prev]);\r\n  if (typeof current === \"number\" && type !== TYPE_ARRAY) {\r\n    data[prev] = [];\r\n  } else if (typeof current === \"string\" && type !== TYPE_OBJECT) {\r\n    data[prev] = {};\r\n  }\r\n};\r\n\r\nconst cleanKey = function(key) {\r\n  if (key.match(/\\[\\S+\\]/g)) {\r\n    let result = key.replace(/\\[|\\]/g, \"\");\r\n    if (!Number.isNaN(parseInt(result))) {\r\n      return +result;\r\n    } else {\r\n      throw new Error(`[]中必须为数字`);\r\n    }\r\n  }\r\n  return key.replace(/\\[|\\.|\\]| /g, \"\");\r\n};\r\n\r\nexport default Store;\r\n"],"names":["TYPE_ARRAY","TYPE_OBJECT","_typeOf","val","Object","prototype","toString","call","_deepClone","obj","JSON","parse","stringify","diff","current","prev","result","updateDiff","root","entries","forEach","key","item","value","path","hasOwnProperty","copyCurrent","keys","rk","indexOf","nullDiff","splice","Version","pkg","version","console","log","Store","option","$state","$r","openPart","behavior","methods","pageLisener","nonWritable","state","assign","_create","r","o","$store","useProp","concat","useStore","canUseStore","push","setData","_filterKey","_store","usekey","_destroy","index","findIndex","$openPart","this","pageLife","originPage","Page","originComponent","Component","args","data","some","originCreate","onLoad","apply","arguments","originonDestroy","onUnload","originLife","App","e","behaviors","attached","detached","lifetimes","fn","Error","time","length","diffObj","newObj","pros","map","useprops","useKey","match","RegExp","Promise","resolve","all","then","timeEnd","useKeys","filter","origin","dataHandler","arr","pathHandler","d","i","keyArr","len","cleanAndPush","cleanKey","keyToData","type","replace","Number","isNaN","parseInt"],"mappings":"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"}